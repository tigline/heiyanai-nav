"use strict";(self.webpackChunkheyanai_navigation=self.webpackChunkheyanai_navigation||[]).push([[527],{88923:function(T,j,e){e.d(j,{h:function(){return C}});var D=e(97857),g=e.n(D),c=e(15009),p=e.n(c),y=e(99289),t=e.n(y),m=e(59061),_=e(80854),h=e(22247),b=e(93717),f=e(96486),U=e.n(f),E=e(491),x=e(85893);function C(I){var n=(0,_.useIntl)();return(0,x.jsx)(m.Z,g()(g()({accept:"image/png",max:1,transform:function(P){var M,v,i={};return(0,f.set)(i,(M=I.name)!==null&&M!==void 0?M:"picture",(v=(0,f.first)(P))===null||v===void 0?void 0:v.response),i}},I),{},{fieldProps:{listType:"picture-card",onPreview:function(P){h.Z.warning({content:(0,x.jsx)(b.Z,{width:600,src:P.thumbUrl}),width:660-12,icon:" "})},customRequest:function(){var B=t()(p()().mark(function M(v){var i,r,o,l;return p()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return i=v.file,r=new FormData,r.append("file",i),s.prev=3,s.next=6,(0,E.cT)(r);case 6:l=s.sent,console.log(l),(o=v.onSuccess)===null||o===void 0||o.call(v,l.data.url),s.next=14;break;case 11:s.prev=11,s.t0=s.catch(3),console.log(s.t0);case 14:case"end":return s.stop()}},M,null,[[3,11]])}));function P(M){return B.apply(this,arguments)}return P}()}}))}},89512:function(T,j,e){e.d(j,{v:function(){return y}});var D=e(80854),g=e(86738),c=e(71577),p=e(85893);function y(t){var m,_,h,b,f=(0,D.useIntl)();return(0,p.jsx)(g.Z,{title:(m=t.title)!==null&&m!==void 0?m:f.formatMessage({id:"app.remove.confirm.title",defaultMessage:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u6B64\u9879\u5417?"}),description:(_=t.title)!==null&&_!==void 0?_:f.formatMessage({id:"app.remove.confirm.description",defaultMessage:"\u5220\u9664\u6B64\u9879"}),okButtonProps:{loading:t.loading},getPopupContainer:t.getPopupContainer,onConfirm:function(){var E;return t==null||(E=t.onClick)===null||E===void 0?void 0:E.call(t)},children:!t.children&&(0,p.jsx)(c.ZP,{type:(h=t.type)!==null&&h!==void 0?h:"link",size:(b=t.size)!==null&&b!==void 0?b:"small",disabled:t.disabled,children:(0,p.jsx)(D.FormattedMessage,{id:"app.remove",defaultMessage:"\u5220\u9664"})})})}},83040:function(T,j,e){e.r(j),e.d(j,{default:function(){return v}});var D=e(89512),g=e(491),c=e(69851),p=e(90930),y=e(64176),t=e(80854),m=e(54689),_=e(71577),h=e(93717),b=e(5574),f=e.n(b),U=e(88923),E=e(51042),x=e(37476),C=e(5966),I=e(12029),n=e(85893);function B(i){var r=(0,t.useIntl)(),o=I.Z.useForm(),l=f()(o,1),d=l[0];return(0,n.jsxs)(x.Y,{title:(0,n.jsx)(t.FormattedMessage,{id:"pages.system.map-setup.building.add",defaultMessage:"\u6DFB\u52A0\u5EFA\u7B51"}),layout:"horizontal",form:d,labelCol:{xs:6},wrapperCol:{xs:16},onFinish:function(a){return(0,g.yB)(a).then(function(R){if(R.code===c.OK){var u;(u=i.refresh)===null||u===void 0||u.call(i),m.Z.success({message:r.formatMessage({id:"app.add.success",defaultMessage:"\u65B0\u5EFA\u6210\u529F"})})}return R.code===c.OK})},modalProps:{destroyOnClose:!0,onCancel:function(){return console.log("run")}},trigger:(0,n.jsxs)(_.ZP,{type:"primary",children:[(0,n.jsx)(E.Z,{}),r.formatMessage({id:"app.add",defaultMessage:"\u65B0\u5EFA"})]}),children:[(0,n.jsx)(C.Z,{width:"lg",name:"name",label:r.formatMessage({id:"pages.system.map-setup.building.name",defaultMessage:"\u5EFA\u7B51\u540D"}),rules:[{required:!0,message:r.formatMessage({id:"pages.system.map-setup.building.name.required.failure",defaultMessage:"\u5EFA\u7B51\u540D\u5FC5\u586B"})}]}),(0,n.jsx)(C.Z,{width:"lg",name:"address",label:r.formatMessage({id:"pages.system.map-setup.building.address",defaultMessage:"\u5730\u5740"}),rules:[{required:!0,message:r.formatMessage({id:"pages.system.map-setup.building.address.required.failure",defaultMessage:"\u5730\u5740\u5FC5\u586B"})}]}),(0,n.jsx)(U.h,{width:"lg",name:"picture",accept:"image/png",label:r.formatMessage({id:"pages.system.map-setup.building.picture",defaultMessage:"\u793A\u610F\u56FE"}),rules:[{required:!0,message:r.formatMessage({id:"pages.system.map-setup.building.picture.required.failure",defaultMessage:"\u793A\u610F\u56FE\u5FC5\u586B"})}]})]})}var P=e(47389);function M(i){var r,o,l,d,s,a=(0,t.useIntl)(),R=I.Z.useForm(),u=f()(R,1),O=u[0],A=(r=i.record)===null||r===void 0?void 0:r.buildingId;return(0,n.jsxs)(x.Y,{title:(0,n.jsx)(t.FormattedMessage,{id:"pages.system.map-setup.building.add",defaultMessage:"\u6DFB\u52A0\u5EFA\u7B51"}),layout:"horizontal",form:O,disabled:i.disabled,labelCol:{xs:6},wrapperCol:{xs:16},onVisibleChange:function(F){F||O.resetFields()},onFinish:function(F){return A?(0,g.Fn)({buildingId:A},F).then(function(Z){if(Z.code===c.OK){var K;(K=i.refresh)===null||K===void 0||K.call(i),m.Z.success({message:a.formatMessage({id:"app.edit.success",defaultMessage:"\u66F4\u65B0\u6210\u529F"})})}return Z.code===c.OK}):(m.Z.error({message:"building id is null"}),Promise.resolve(!1))},trigger:(0,n.jsxs)(_.ZP,{children:[(0,n.jsx)(P.Z,{}),a.formatMessage({id:"app.edit",defaultMessage:"\u7F16\u8F91"})]}),children:[(0,n.jsx)(C.Z,{width:"lg",name:"name",initialValue:(o=i.record)===null||o===void 0?void 0:o.name,label:a.formatMessage({id:"pages.system.map-setup.building.name",defaultMessage:"\u5EFA\u7B51\u540D"}),rules:[{required:!0,message:a.formatMessage({id:"pages.system.map-setup.building.name.required.failure",defaultMessage:"\u5EFA\u7B51\u540D\u5FC5\u586B"})}]}),(0,n.jsx)(C.Z,{width:"lg",name:"address",initialValue:(l=i.record)===null||l===void 0?void 0:l.address,label:a.formatMessage({id:"pages.system.map-setup.building.address",defaultMessage:"\u5730\u5740"}),rules:[{required:!0,message:a.formatMessage({id:"pages.system.map-setup.building.address.required.failure",defaultMessage:"\u5730\u5740\u5FC5\u586B"})}]}),(0,n.jsx)(U.h,{width:"lg",name:"picture",accept:"image/png",initialValue:[{uid:Date.now()+"",response:(d=i.record)===null||d===void 0?void 0:d.picture,thumbUrl:(s=i.record)===null||s===void 0?void 0:s.picture}],label:a.formatMessage({id:"pages.system.map-setup.building.picture",defaultMessage:"\u793A\u610F\u56FE"}),rules:[{required:!0,message:a.formatMessage({id:"pages.system.map-setup.building.picture.required.failure",defaultMessage:"\u793A\u610F\u56FE\u5FC5\u586B"})}]})]})}function v(){var i=(0,t.useIntl)(),r=(0,t.useRequest)(g.Pt,{manual:!0,fetchKey:function(s){return s.buildingId},onSuccess:function(s){s&&m.Z.success({message:i.formatMessage({id:"app.remove.success",defaultMessage:"\u5220\u9664\u6210\u529F"})})}}),o=r.run,l=r.fetches;return(0,n.jsx)(p._z,{childrenContentStyle:{padding:20},children:(0,n.jsx)(y.Rs,{pagination:!1,request:function(s){return(0,g.CW)({name:s.name}).then(function(a){return{data:a.data,success:a.code===c.OK}})},search:{},toolBarRender:function(s){return[(0,n.jsx)(B,{refresh:s==null?void 0:s.reload},"add")]},itemLayout:"vertical",metas:{title:{dataIndex:"name",title:i.formatMessage({id:"pages.system.map-setup.building.name",defaultMessage:"\u5EFA\u7B51\u540D"}),render:function(s,a){return a.name}},description:{render:function(s,a){return a.address},search:!1},actions:{cardActionProps:"extra",render:function(s,a,R,u){var O;return[(0,n.jsx)(M,{disabled:!a.buildingId,record:a,refresh:u==null?void 0:u.reload},"add"),(0,n.jsx)(_.ZP,{children:(0,n.jsx)(t.Link,{to:"/system/map-setup/floor-manager.page/".concat(a.buildingId),children:i.formatMessage({id:"app.view",defaultMessage:"\u67E5\u770B"})})},"view"),(0,n.jsx)(D.v,{size:"middle",type:"default",disabled:!a.buildingId,onClick:function(){return o({buildingId:a.buildingId}).then(function(){u==null||u.reload()})},loading:l==null||(O=l[a.buildingId])===null||O===void 0?void 0:O.loading},"remove")]}},content:{render:function(){return" "},search:!1},extra:{search:!1,render:function(s,a){return(0,n.jsx)(h.Z,{width:400,height:200,alt:"logo",src:a.picture})}}}})})}}}]);
