"use strict";(self.webpackChunkheyanai_navigation=self.webpackChunkheyanai_navigation||[]).push([[527],{88923:function(T,y,e){e.d(y,{h:function(){return b}});var O=e(97857),g=e.n(O),f=e(15009),M=e.n(f),C=e(99289),t=e.n(C),m=e(59061),v=e(35312),h=e(69400),E=e(90156),c=e(96486),U=e.n(c),P=e(491),x=e(85893);function b(I){var n=(0,v.useIntl)();return(0,x.jsx)(m.Z,g()(g()({accept:"image/png",max:1,transform:function(j){var p,_,i={};return(0,c.set)(i,(p=I.name)!==null&&p!==void 0?p:"picture",(_=(0,c.first)(j))===null||_===void 0?void 0:_.response),i}},I),{},{fieldProps:{listType:"picture-card",onPreview:function(j){h.Z.warning({content:(0,x.jsx)(E.Z,{width:600,src:j.thumbUrl}),width:660-12,icon:" "})},customRequest:function(){var B=t()(M()().mark(function p(_){var i,r,o,l;return M()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return i=_.file,r=new FormData,r.append("file",i),s.prev=3,s.next=6,(0,P.cT)(r);case 6:l=s.sent,console.log(l),(o=_.onSuccess)===null||o===void 0||o.call(_,l.data.url),s.next=14;break;case 11:s.prev=11,s.t0=s.catch(3),console.log(s.t0);case 14:case"end":return s.stop()}},p,null,[[3,11]])}));function j(p){return B.apply(this,arguments)}return j}()}}))}},89512:function(T,y,e){e.d(y,{v:function(){return C}});var O=e(35312),g=e(86738),f=e(71577),M=e(85893);function C(t){var m,v,h,E,c=(0,O.useIntl)();return(0,M.jsx)(g.Z,{title:(m=t.title)!==null&&m!==void 0?m:c.formatMessage({id:"app.remove.confirm.title",defaultMessage:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u6B64\u9879\u5417?"}),description:(v=t.title)!==null&&v!==void 0?v:c.formatMessage({id:"app.remove.confirm.description",defaultMessage:"\u5220\u9664\u6B64\u9879"}),okButtonProps:{loading:t.loading},getPopupContainer:t.getPopupContainer,onConfirm:function(){var P;return t==null||(P=t.onClick)===null||P===void 0?void 0:P.call(t)},children:!t.children&&(0,M.jsx)(f.ZP,{type:(h=t.type)!==null&&h!==void 0?h:"link",size:(E=t.size)!==null&&E!==void 0?E:"small",disabled:t.disabled,children:(0,M.jsx)(O.FormattedMessage,{id:"app.remove",defaultMessage:"\u5220\u9664"})})})}},83040:function(T,y,e){e.r(y),e.d(y,{default:function(){return _}});var O=e(89512),g=e(491),f=e(69851),M=e(90930),C=e(26950),t=e(35312),m=e(54689),v=e(71577),h=e(90156),E=e(5574),c=e.n(E),U=e(88923),P=e(51042),x=e(37476),b=e(5966),I=e(12029),n=e(85893);function B(i){var r=(0,t.useIntl)(),o=I.Z.useForm(),l=c()(o,1),d=l[0];return(0,n.jsxs)(x.Y,{title:(0,n.jsx)(t.FormattedMessage,{id:"pages.system.map-setup.building.add",defaultMessage:"\u6DFB\u52A0\u5EFA\u7B51"}),layout:"horizontal",form:d,labelCol:{xs:6},wrapperCol:{xs:16},onFinish:function(a){return(0,g.yB)(a).then(function(R){if(R.code===f.OK){var u;(u=i.refresh)===null||u===void 0||u.call(i),m.Z.success({message:r.formatMessage({id:"app.add.success",defaultMessage:"\u65B0\u5EFA\u6210\u529F"})})}return R.code===f.OK})},modalProps:{destroyOnClose:!0,onCancel:function(){return console.log("run")}},trigger:(0,n.jsxs)(v.ZP,{type:"primary",children:[(0,n.jsx)(P.Z,{}),r.formatMessage({id:"app.add",defaultMessage:"\u65B0\u5EFA"})]}),children:[(0,n.jsx)(b.Z,{width:"lg",name:"name",label:r.formatMessage({id:"pages.system.map-setup.building.name",defaultMessage:"\u5EFA\u7B51\u540D"}),rules:[{required:!0,message:r.formatMessage({id:"pages.system.map-setup.building.name.required.failure",defaultMessage:"\u5EFA\u7B51\u540D\u5FC5\u586B"})}]}),(0,n.jsx)(b.Z,{width:"lg",name:"address",label:r.formatMessage({id:"pages.system.map-setup.building.address",defaultMessage:"\u5730\u5740"}),rules:[{required:!0,message:r.formatMessage({id:"pages.system.map-setup.building.address.required.failure",defaultMessage:"\u5730\u5740\u5FC5\u586B"})}]}),(0,n.jsx)(U.h,{width:"lg",name:"picture",accept:"image/png",label:r.formatMessage({id:"pages.system.map-setup.building.picture",defaultMessage:"\u793A\u610F\u56FE"}),rules:[{required:!0,message:r.formatMessage({id:"pages.system.map-setup.building.picture.required.failure",defaultMessage:"\u793A\u610F\u56FE\u5FC5\u586B"})}]})]})}var j=e(47389);function p(i){var r,o,l,d,s,a=(0,t.useIntl)(),R=I.Z.useForm(),u=c()(R,1),D=u[0],A=(r=i.record)===null||r===void 0?void 0:r.buildingId;return(0,n.jsxs)(x.Y,{title:(0,n.jsx)(t.FormattedMessage,{id:"pages.system.map-setup.building.add",defaultMessage:"\u6DFB\u52A0\u5EFA\u7B51"}),layout:"horizontal",form:D,disabled:i.disabled,labelCol:{xs:6},wrapperCol:{xs:16},onVisibleChange:function(F){F||D.resetFields()},onFinish:function(F){return A?(0,g.Fn)({buildingId:A},F).then(function(Z){if(Z.code===f.OK){var K;(K=i.refresh)===null||K===void 0||K.call(i),m.Z.success({message:a.formatMessage({id:"app.edit.success",defaultMessage:"\u66F4\u65B0\u6210\u529F"})})}return Z.code===f.OK}):(m.Z.error({message:"building id is null"}),Promise.resolve(!1))},trigger:(0,n.jsxs)(v.ZP,{children:[(0,n.jsx)(j.Z,{}),a.formatMessage({id:"app.edit",defaultMessage:"\u7F16\u8F91"})]}),children:[(0,n.jsx)(b.Z,{width:"lg",name:"name",initialValue:(o=i.record)===null||o===void 0?void 0:o.name,label:a.formatMessage({id:"pages.system.map-setup.building.name",defaultMessage:"\u5EFA\u7B51\u540D"}),rules:[{required:!0,message:a.formatMessage({id:"pages.system.map-setup.building.name.required.failure",defaultMessage:"\u5EFA\u7B51\u540D\u5FC5\u586B"})}]}),(0,n.jsx)(b.Z,{width:"lg",name:"address",initialValue:(l=i.record)===null||l===void 0?void 0:l.address,label:a.formatMessage({id:"pages.system.map-setup.building.address",defaultMessage:"\u5730\u5740"}),rules:[{required:!0,message:a.formatMessage({id:"pages.system.map-setup.building.address.required.failure",defaultMessage:"\u5730\u5740\u5FC5\u586B"})}]}),(0,n.jsx)(U.h,{width:"lg",name:"picture",accept:"image/png",initialValue:[{uid:Date.now()+"",response:(d=i.record)===null||d===void 0?void 0:d.picture,thumbUrl:(s=i.record)===null||s===void 0?void 0:s.picture}],label:a.formatMessage({id:"pages.system.map-setup.building.picture",defaultMessage:"\u793A\u610F\u56FE"}),rules:[{required:!0,message:a.formatMessage({id:"pages.system.map-setup.building.picture.required.failure",defaultMessage:"\u793A\u610F\u56FE\u5FC5\u586B"})}]})]})}function _(){var i=(0,t.useIntl)(),r=(0,t.useRequest)(g.Pt,{manual:!0,fetchKey:function(s){return s.buildingId},onSuccess:function(s){s&&m.Z.success({message:i.formatMessage({id:"app.remove.success",defaultMessage:"\u5220\u9664\u6210\u529F"})})}}),o=r.run,l=r.fetches;return(0,n.jsx)(M._z,{childrenContentStyle:{padding:20},children:(0,n.jsx)(C.Rs,{pagination:!1,request:function(s){return(0,g.CW)({name:s.name}).then(function(a){return{data:a.data,success:a.code===f.OK}})},search:{},toolBarRender:function(s){return[(0,n.jsx)(B,{refresh:s==null?void 0:s.reload},"add")]},itemLayout:"vertical",metas:{title:{dataIndex:"name",title:i.formatMessage({id:"pages.system.map-setup.building.name",defaultMessage:"\u5EFA\u7B51\u540D"}),render:function(s,a){return a.name}},description:{render:function(s,a){return a.address},search:!1},actions:{cardActionProps:"extra",render:function(s,a,R,u){var D;return[(0,n.jsx)(p,{disabled:!a.buildingId,record:a,refresh:u==null?void 0:u.reload},"add"),(0,n.jsx)(v.ZP,{children:(0,n.jsx)(t.Link,{to:"/system/map-setup/floor-manager.page/".concat(a.buildingId),children:i.formatMessage({id:"app.view",defaultMessage:"\u67E5\u770B"})})},"view"),(0,n.jsx)(O.v,{size:"middle",type:"default",disabled:!a.buildingId,onClick:function(){return o({buildingId:a.buildingId}).then(function(){u==null||u.reload()})},loading:l==null||(D=l[a.buildingId])===null||D===void 0?void 0:D.loading},"remove")]}},content:{render:function(){return" "},search:!1},extra:{search:!1,render:function(s,a){return(0,n.jsx)(h.Z,{width:400,height:200,alt:"logo",src:a.picture})}}}})})}}}]);
